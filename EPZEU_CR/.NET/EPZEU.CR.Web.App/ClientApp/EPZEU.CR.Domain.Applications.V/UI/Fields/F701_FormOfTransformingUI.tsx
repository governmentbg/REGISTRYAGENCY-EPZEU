import { ObjectHelper } from 'Cnsys.Core';
import { EPZEUBaseComponent, ValidationSummaryStrategy } from 'EPZEU.Core';
import { FieldContainerProps, withFieldRecordContainer } from 'EPZEU.CR.Domain';
import { action } from 'mobx';
import { observer } from 'mobx-react';
import * as React from "react";
import { F701_FormOfTransforming701 } from '../../Models/Fields/ModelsAutoGenerated';

interface F701_FormOfTransformingProps extends FieldContainerProps {
    formsOfTransforming: FormsOfTransforming[];
    onChangeFormOfTransforming?: () => void;
}

export enum FormsOfTransforming {
    /**разделяне*/
    Separation,
    /**отделяне*/
    Division,
    /**сливане*/
    Fusion,
    /**вливане*/
    Influx,
    /**прехвърляне на имуществото върху едноличния собственик*/
    TransferringProperty,
    /**промяна на правна форма*/
    ChangeLegalForm,
    /**преобразуване на европейско дружество със седалище в Р. България в акционерно дружество със седалище в Р. България*/
    ConversionOfBulgarianEuropeanCompanyIntoBulgarianPLC,
    /**преобразуване на акционерно дружество със седалище в Р. България в европейско дружество със седалище в Р. България*/
    ConversionOfBulgarianPLCIntoBulgarianEuropeanCompany
}

@observer class F701_FormOfTransformingUI extends EPZEUBaseComponent<F701_FormOfTransformingProps, F701_FormOfTransforming701> {
    private groupName: string;

    constructor(props: F701_FormOfTransformingProps) {
        super(props);
        this.groupName = ObjectHelper.newGuid();
        this.onChangeFormOfTransforming = this.onChangeFormOfTransforming.bind(this);
        this.getFormOfTransformingUI = this.getFormOfTransformingUI.bind(this);
    }

    renderEdit(): JSX.Element {
        return (
            <>
                <div className="row">
                    <div className="form-group col-12">
                        {
                            this.props.formsOfTransforming.map((form: FormsOfTransforming, index: number) => {
                                return <React.Fragment key={index}>{this.getFormOfTransformingUI(form)}</React.Fragment>
                            })
                        }
                    </div>
                </div>
            </>
        )
    }

    renderDisplay(): JSX.Element {
        return (
            <>
                {this.model.division && this.getResource('CR_APP_SEPARATION_L')}
                {this.model.separation && this.getResource('CR_APP_DETACHMENT_L')}
                {this.model.fusion && this.getResource('CR_APP_INTERFLOW_L')}
                {this.model.influx && this.getResource('CR_APP_INFUSION_L')}
                {this.model.transferringProperty && this.getResource('CR_APP_TRANSFER_PROPERTY_TO_SOLE_OWNER_L')}
                {this.model.changeLegalForm && this.getResource('CR_APP_CHANGE_LEGAL_FORM_L')}
                {this.model.conversionOfBulgarianEuropeanCompanyIntoBulgarianPLC && this.getResource('CR_APP_TRANSFORMATION_EUROPEAN_COMPANY_TO_PUBLIC_LIMITED_COMPANY_L')}
                {this.model.conversionOfBulgarianPLCIntoBulgarianEuropeanCompany && this.getResource('CR_APP_TRANSFORMATION_PUBLIC_LIMITED_COMPANY_TO_EUROPEAN_COMPANY_L')}
            </>
        );
    }

    @action private onChangeFormOfTransforming(e: any) {
        this.model.separation = this.model.division = this.model.fusion = this.model.influx = this.model.transferringProperty = false;
        this.model.changeLegalForm = this.model.conversionOfBulgarianEuropeanCompanyIntoBulgarianPLC = this.model.conversionOfBulgarianPLCIntoBulgarianEuropeanCompany = false;

        switch (e.target.value) {
            case 'separation':
                this.model.separation = true; break;
            case 'division':
                this.model.division = true; break;
            case 'fusion':
                this.model.fusion = true; break;
            case 'influx':
                this.model.influx = true; break;
            case 'transferringProperty':
                this.model.transferringProperty = true; break;
            case 'changeLegalForm':
                this.model.changeLegalForm = true; break;
            case 'conversionOfBulgarianEuropeanCompanyIntoBulgarianPLC':
                this.model.conversionOfBulgarianEuropeanCompanyIntoBulgarianPLC = true; break;
            case 'conversionOfBulgarianPLCIntoBulgarianEuropeanCompany':
                this.model.conversionOfBulgarianPLCIntoBulgarianEuropeanCompany = true; break;
            default:
        }

        this.props.onChangeFormOfTransforming && this.props.onChangeFormOfTransforming();
    }

    private getFormOfTransformingUI(formOfTransforming: FormsOfTransforming): JSX.Element {
        switch (formOfTransforming) {
            case FormsOfTransforming.Division:
                return this.getFormOfTransformingElement('division', 'CR_APP_SEPARATION_L', this.model.division);
            case FormsOfTransforming.Separation:
                return this.getFormOfTransformingElement('separation', 'CR_APP_DETACHMENT_L', this.model.separation);
            case FormsOfTransforming.Fusion:
                return this.getFormOfTransformingElement('fusion', 'CR_APP_INTERFLOW_L', this.model.fusion);
            case FormsOfTransforming.Influx:
                return this.getFormOfTransformingElement('influx', 'CR_APP_INFUSION_L', this.model.influx);
            case FormsOfTransforming.TransferringProperty:
                return this.getFormOfTransformingElement('transferringProperty', 'CR_APP_TRANSFER_PROPERTY_TO_SOLE_OWNER_L', this.model.transferringProperty);
            case FormsOfTransforming.ChangeLegalForm:
                return this.getFormOfTransformingElement('changeLegalForm', 'CR_APP_CHANGE_LEGAL_FORM_L', this.model.changeLegalForm);
            case FormsOfTransforming.ConversionOfBulgarianEuropeanCompanyIntoBulgarianPLC:
                return this.getFormOfTransformingElement(
                    'conversionOfBulgarianEuropeanCompanyIntoBulgarianPLC',
                    'CR_APP_TRANSFORMATION_EUROPEAN_COMPANY_TO_PUBLIC_LIMITED_COMPANY_L',
                    this.model.conversionOfBulgarianEuropeanCompanyIntoBulgarianPLC);
            case FormsOfTransforming.ConversionOfBulgarianPLCIntoBulgarianEuropeanCompany:
                return this.getFormOfTransformingElement(
                    'conversionOfBulgarianPLCIntoBulgarianEuropeanCompany',
                    'CR_APP_TRANSFORMATION_PUBLIC_LIMITED_COMPANY_TO_EUROPEAN_COMPANY_L',
                    this.model.conversionOfBulgarianPLCIntoBulgarianEuropeanCompany);
            default:
                return null;
        }
    }

    private getFormOfTransformingElement(formOfTransforming: string, resourceKeyCode: string, isChecked: boolean): JSX.Element {
        return (
            <div className="custom-control custom-radio">
                <input className="custom-control-input" type="radio" onChange={this.onChangeFormOfTransforming} id={this.groupName + formOfTransforming} name={this.groupName} value={formOfTransforming} checked={isChecked} />
                <label className="custom-control-label" htmlFor={this.groupName + formOfTransforming}>{this.getResource(resourceKeyCode)}</label>
            </div>
        );
    }
}

export const F701_FormOfTransformingFieldUI = withFieldRecordContainer(F701_FormOfTransformingUI, {
    fieldLabelTextKey: "CR_F_701_L",
    isMandatoryField: true,
    valSummaryStrategy: ValidationSummaryStrategy.excludeAllExcept,
    valSummaryRecursive: true,
    valSummaryPropNames: ["", "separation"]
});